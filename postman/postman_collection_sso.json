{
  "info": {
    "name": "Backend SIKP API (SSO Integrated)",
    "description": "Collection untuk testing Backend SIKP dengan SSO UNSRI Integration",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "2.0.0"
  },
  "variable": [
    {
      "key": "authServiceUrl",
      "value": "http://localhost:8787",
      "type": "string"
    },
    {
      "key": "profileServiceUrl",
      "value": "http://localhost:8788",
      "type": "string"
    },
    {
      "key": "backendSikpUrl",
      "value": "http://localhost:8789",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "mahasiswaToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "mahasiswa2Token",
      "value": "",
      "type": "string"
    },
    {
      "key": "adminToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "teamId",
      "value": "",
      "type": "string"
    },
    {
      "key": "invitationId",
      "value": "",
      "type": "string"
    },
    {
      "key": "submissionId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "0. Health Check",
      "item": [
        {
          "name": "Auth Service Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{authServiceUrl}}/health",
              "host": ["{{authServiceUrl}}"],
              "path": ["health"]
            }
          }
        },
        {
          "name": "Profile Service Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{profileServiceUrl}}/health",
              "host": ["{{profileServiceUrl}}"],
              "path": ["health"]
            }
          }
        },
        {
          "name": "Backend SIKP Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{backendSikpUrl}}/health",
              "host": ["{{backendSikpUrl}}"],
              "path": ["health"]
            }
          }
        }
      ]
    },
    {
      "name": "1. Auth Service - Register & Login",
      "item": [
        {
          "name": "Register Mahasiswa 1 (Leader)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    console.log('Mahasiswa 1 registered successfully');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"mahasiswa1@student.unsri.ac.id\",\n  \"password\": \"Password123!\",\n  \"role\": \"mahasiswa\",\n  \"nim\": \"09021182025001\"\n}"
            },
            "url": {
              "raw": "{{authServiceUrl}}/api/auth/register",
              "host": ["{{authServiceUrl}}"],
              "path": ["api", "auth", "register"]
            }
          }
        },
        {
          "name": "Register Mahasiswa 2 (Member)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    console.log('Mahasiswa 2 registered successfully');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"mahasiswa2@student.unsri.ac.id\",\n  \"password\": \"Password123!\",\n  \"role\": \"mahasiswa\",\n  \"nim\": \"09021182025002\"\n}"
            },
            "url": {
              "raw": "{{authServiceUrl}}/api/auth/register",
              "host": ["{{authServiceUrl}}"],
              "path": ["api", "auth", "register"]
            }
          }
        },
        {
          "name": "Register Admin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    console.log('Admin registered successfully');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@unsri.ac.id\",\n  \"password\": \"Admin123!\",\n  \"role\": \"admin\",\n  \"nip\": \"199001012020121001\"\n}"
            },
            "url": {
              "raw": "{{authServiceUrl}}/api/auth/register",
              "host": ["{{authServiceUrl}}"],
              "path": ["api", "auth", "register"]
            }
          }
        },
        {
          "name": "Login Mahasiswa 1",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('mahasiswaToken', jsonData.data.access_token);",
                  "    pm.collectionVariables.set('accessToken', jsonData.data.access_token);",
                  "    console.log('Mahasiswa 1 token saved');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"mahasiswa1@student.unsri.ac.id\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{authServiceUrl}}/api/auth/login",
              "host": ["{{authServiceUrl}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "Login Mahasiswa 2",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('mahasiswa2Token', jsonData.data.access_token);",
                  "    console.log('Mahasiswa 2 token saved');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"mahasiswa2@student.unsri.ac.id\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{authServiceUrl}}/api/auth/login",
              "host": ["{{authServiceUrl}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "Login Admin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('adminToken', jsonData.data.access_token);",
                  "    console.log('Admin token saved');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@unsri.ac.id\",\n  \"password\": \"Admin123!\"\n}"
            },
            "url": {
              "raw": "{{authServiceUrl}}/api/auth/login",
              "host": ["{{authServiceUrl}}"],
              "path": ["api", "auth", "login"]
            }
          }
        }
      ]
    },
    {
      "name": "2. Backend SIKP - User Info",
      "item": [
        {
          "name": "Get My Info (Mahasiswa)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/auth/me",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "auth", "me"]
            }
          }
        }
      ]
    },
    {
      "name": "3. Team Management",
      "item": [
        {
          "name": "Create Team (Leader)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('teamId', jsonData.data.id);",
                  "    console.log('Team created with ID:', jsonData.data.id);",
                  "    console.log('Team code:', jsonData.data.code);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams"]
            }
          }
        },
        {
          "name": "Get My Team",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/my-team",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "my-team"]
            }
          }
        },
        {
          "name": "Invite Member (by NIM)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('invitationId', jsonData.data.id);",
                  "    console.log('Invitation sent with ID:', jsonData.data.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"memberNim\": \"09021182025002\"\n}"
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/{{teamId}}/invite",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "{{teamId}}", "invite"]
            }
          }
        },
        {
          "name": "Get My Invitations (Member)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswa2Token}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/my-invitations",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "my-invitations"]
            }
          }
        },
        {
          "name": "Accept Invitation",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswa2Token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"ACCEPT\"\n}"
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/members/{{invitationId}}/respond",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "members", "{{invitationId}}", "respond"]
            }
          }
        },
        {
          "name": "Reject Invitation",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswa2Token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"REJECT\"\n}"
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/members/{{invitationId}}/respond",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "members", "{{invitationId}}", "respond"]
            }
          }
        },
        {
          "name": "Leave Team",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswa2Token}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/leave",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "leave"]
            }
          }
        },
        {
          "name": "Cancel Invitation (Leader)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/teams/invitations/{{invitationId}}/cancel",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "teams", "invitations", "{{invitationId}}", "cancel"]
            }
          }
        }
      ]
    },
    {
      "name": "4. Submission Management",
      "item": [
        {
          "name": "Create Submission",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('submissionId', jsonData.data.id);",
                  "    console.log('Submission created with ID:', jsonData.data.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"companyName\": \"PT Telkom Indonesia\",\n  \"companyAddress\": \"Jl. Jend. Sudirman No. 1, Palembang\",\n  \"companyPhone\": \"0711-123456\",\n  \"companyEmail\": \"hrd@telkom.co.id\",\n  \"companySupervisor\": \"Budi Santoso\",\n  \"position\": \"Software Engineer Intern\",\n  \"startDate\": \"2026-02-01\",\n  \"endDate\": \"2026-05-01\",\n  \"description\": \"Kerja praktik di divisi IT Development\"\n}"
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/submissions",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "submissions"]
            }
          }
        },
        {
          "name": "Get My Submissions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/submissions/my-submissions",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "submissions", "my-submissions"]
            }
          }
        },
        {
          "name": "Get Submission by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/submissions/{{submissionId}}",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "submissions", "{{submissionId}}"]
            }
          }
        },
        {
          "name": "Update Submission",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"companyPhone\": \"0711-999888\",\n  \"description\": \"Kerja praktik di divisi IT Development - Updated\"\n}"
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/submissions/{{submissionId}}",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "submissions", "{{submissionId}}"]
            }
          }
        },
        {
          "name": "Submit for Review",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{mahasiswaToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/submissions/{{submissionId}}/submit",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "submissions", "{{submissionId}}", "submit"]
            }
          }
        }
      ]
    },
    {
      "name": "5. Admin - Review & Approval",
      "item": [
        {
          "name": "Get All Submissions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/submissions",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "submissions"]
            }
          }
        },
        {
          "name": "Get Submissions by Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/submissions/status/MENUNGGU",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "submissions", "status", "MENUNGGU"]
            }
          }
        },
        {
          "name": "Get Submission Detail",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/submissions/{{submissionId}}",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "submissions", "{{submissionId}}"]
            }
          }
        },
        {
          "name": "Approve Submission",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/submissions/{{submissionId}}/approve",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "submissions", "{{submissionId}}", "approve"]
            }
          }
        },
        {
          "name": "Reject Submission",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"rejectionReason\": \"Data perusahaan tidak lengkap, mohon dilengkapi\"\n}"
            },
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/submissions/{{submissionId}}/reject",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "submissions", "{{submissionId}}", "reject"]
            }
          }
        },
        {
          "name": "Generate Letter",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/submissions/{{submissionId}}/generate-letter",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "submissions", "{{submissionId}}", "generate-letter"]
            }
          }
        },
        {
          "name": "Get Statistics",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{backendSikpUrl}}/api/admin/statistics",
              "host": ["{{backendSikpUrl}}"],
              "path": ["api", "admin", "statistics"]
            }
          }
        }
      ]
    }
  ]
}
